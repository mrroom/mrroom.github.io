<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Mr.Rooom System</title>

    <!-- Bootstrap core CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" >
    <meta name="theme-color" content="#563d7c">

    <!-- Font Awesome -->
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Favicons -->
    <link rel="icon" href="https://avatars2.githubusercontent.com/u/1829186?s=460&u=9ebbabb4ebc8f4155d1ff63f92a6c70177523317&v=4" sizes="32x32" type="image/png">
    <!--<link href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.css" rel="stylesheet" />-->
    <link rel="stylesheet" href="./css/github2.css" />
    <!--<link rel="stylesheet" href="./css/custom.css" />-->

    <!-- Custom styles for this template -->
    <style>
        
        .side_menu {
            border-left: 0.5px dotted lightgrey;
            border-right: 0.5px dotted lightgrey;
        }

        .child_menu {
            display: none; 
        }

        .side_menu span.fa {
            float: right;
            text-align: center;
            margin-top: 5px;
            font-size: 10px;
        }

        .side_menu ul {
            list-style:none;
            padding-inline-start: 20px;
        }

        .side_menu ul li {
            line-height: 30px;
        }

        .side_menu a {
            color: black;
        }

    </style>

</head>

<body id="body" >
    <div id="app">

        <!--hader-->
        <header class="container-fluid header" id="header_div">
        </header>

        <!--main-->
        <main class="container-fluid" id="body_div">
            <div class="row">
                <div class="col-md-10">
                    <h3>home main</h3>
                    <div class="py-md-3 pl-md-5 bd-content github" id="md_content"></div>
                </div>

                <aside id="sidebar-menu" class="col-md-2 side_menu">
                    <div class="menu_section">
                        <h3>목차</h3>
                        <!-- 
                        <ul class="side-menu">
                            <li>
                                <a><i class="fa fa-sitemap"></i> 메뉴1 <span class="fa fa-chevron-down"></span></a>
                                <ul class="child_menu">
                                    <li><a href="#level1_1">Level One</a>
                                    <li><a>Level One<span class="fa fa-chevron-down"></span></a>
                                    <ul class="child_menu">
                                        <li><a href="level2.html">Level Two</a>
                                        </li>
                                        <li><a href="#level2_1">Level Two</a>
                                        </li>
                                        <li><a href="#level2_2">Level Two</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><a href="#level1_2">Level One</a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a><i class="fa fa-sitemap"></i> 메뉴2 <span class="fa fa-chevron-down"></span></a>
                                <ul class="child_menu">
                                    <li><a href="#level1_1">Level One</a>
                                    <li><a>Level One<span class="fa fa-chevron-down"></span></a>
                                    <ul class="child_menu">
                                        <li><a href="level2.html">Level Two</a>
                                        </li>
                                        <li><a href="#level2_1">Level Two</a>
                                        </li>
                                        <li><a href="#level2_2">Level Two</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><a href="#level1_2">Level One</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        -->
                        <ul class="side-menu">
                            <li class="node_temp">
                                <a><span class="fa fa-chevron-down"></span><span class="node_text">메뉴1</span></a>
                                <ul class="child_menu">
                                </ul>
                            </li>
                            <li class="node_temp"><a href="#level0_1"><span class="node_text">메뉴2</span></a></li>
                        </ul>
                    </div>
                </aside>
            </div><!-- /.row -->
        </main>

        <!--footer-->
        <footer class="container-fluid" id="footer_div">
        </footer>

    </div>
</body>
<!--script-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>
<!--<script src="./js/custom.js"></script>-->
<script>

    $(function() {
        
        //헤더 & 풋터 페이지 삽입
        load_header_footer();

        //사이드 메뉴 로드
        load_side_menu();

        //사이드 트리 메뉴 로드 및 바인딩
        load_side_tree_menu();

        //마크다운 파일 로드
        load_markdown("/doc/intro.md");


    });

    //헤더 & 풋터 페이지 삽입
    var load_header_footer = function(){

        var path = window.location.pathname;
        path = path.substr(0, path.lastIndexOf("/"));
        if(path.lastIndexOf("/") > 0 ) path = path.substr(0, path.lastIndexOf("/"));
        console.log(window.location.pathname, path);

        //헤더 페이지 삽입 : JQuery 사용
        $("#header_div").load(path + "/header.html", function(){
            //페이지 삽입 후 Header객체 처리
            //첫페이지 메뉴 active 처리
            //Header.menu_id ="index";
        });

        //풋터 페이지 삽입 : JQuery 사용
        $("#footer_div").load(path + "/footer.html" );
        
    }

    //마크다운 파일 로드
    var load_markdown = function(file) {

        var path = window.location.pathname;
        path = path.substr(0, path.lastIndexOf("/"));
        if(path.lastIndexOf("/") > 0 ) path = path.substr(0, path.lastIndexOf("/"));
        console.log("path : ", path);

        $.get(path + file, function(data) {
            convert_html(data);
        },"text");
    }

    //마크다운을 HTML로 변환
    var convert_html = function(data, callback) {

         var converter = new showdown.Converter({disableForced4SpacesIndentedSublists : true});
        converter.setFlavor("github");
        $("#md_content").html(converter.makeHtml(data));

        if(callback) callback();
    }

    //사이드 메뉴 로드
    var load_side_menu = function() {

        //기본은 열려져 있게 세팅
        $("#sidebar-menu").find('li ul').slideDown();

        //클릭시 트리메뉴 열리고 닫기
        $("#sidebar-menu").find("a").click(function(){
            $(this).next("ul").slideToggle("fast");
        });

    }

    //column 데이터를 array로 가져온다
    var get_filter_data = function(data, filter_column, filter_value) {

        //console.log(filter_column, filter_value)
        var filter_data = data.filter(function(object) {
            return object[filter_column]===filter_value;
        });

        console.log("filter_data1 : ", filter_data);

        return filter_data;

    }

    //사이드 트리 메뉴 로드 및 바인딩
    var load_side_tree_menu = function(){

        var path = window.location.pathname;
        path = path.substr(0, path.lastIndexOf("/"));
        if(path.lastIndexOf("/") > 0 ) path = path.substr(0, path.lastIndexOf("/"));
        
        $.getJSON(path + "/contents.json", function(data) {

            var items = [];

            var filter_data = get_filter_data(data, "parent_code", "");
            console.log("filter_data2 : ", filter_data);


            var new_menu1 = $(".side-menu li").eq(0).clone().appendTo(".side-menu");
            var new_menu2 = $(".side-menu li").eq(1).clone().appendTo(".side-menu");

            new_menu1.addClass("node_multi");
            new_menu2.addClass("node_single");
            new_menu1.removeClass("node_temp");
            new_menu2.removeClass("node_temp");

            $(".side-menu").find(".node_temp").remove();

            new_menu1.find("span.node_text").text("메뉴11");
            new_menu2.find("span.node_text").text("메뉴22");

            $.each(data, function(index, item) {
                //var new_menu1 = $("side-menu li").first().clone().appendTo(".side-menu");
                //var new_menu2 = $("side-menu li").second().clone().appendTo(".side-menu");

                //console.log(new_menu1, new_menu2);

                /*
                new_menu.attr("code", item.code);
                new_menu.children("a").first().attr("href", path + item.url);
                new_menu.children("a").first().text(item.text);
                new_menu.removeClass("active");

                //window.location.pathname와 path + url이 일치시는 메뉴 활성화
                if(path + item.url == window.location.pathname){
                    new_menu.addClass("active");
                }
                */

            });

        });
    }


</script>
</html>
